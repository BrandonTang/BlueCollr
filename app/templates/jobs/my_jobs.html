{% extends "layout/base.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block title %}
My Jobs
{% endblock %}

{% block about %}
<section id="portfolio" style="margin-top: 5%;">
    <div class="container" style="text-align: center;">

        <h5 style="color: darkblue;">
            {% with messages = get_flashed_messages() %}
            {% if messages %}
            {% for message in messages %}
            {{ message }}
            {% endfor %}
            {% endif %}
            {% endwith %}
        </h5>

        <h2 class="text-center">My Jobs</h2>
        <a href="{{ url_for('jobs.create') }}" class="btn btn-lg btn-outline"
           style="background-color: #2c3e50; color: white;">
            <i class="fa fa-pencil-square-o"></i>
            Post Job
        </a>

        {% if not jobs %}
            <hr>
            <div class="row" style="display: inline-block; margin: 1%;">
                No jobs have been created. Click the 'Post Job' button above to post one!
            </div>
            <br>
        {% else %}
            {% for job in jobs %}
            <hr>
            <div class="row" style="display: inline-block; margin: 1%;">
                <h3>{{ job.name }}</h3>
                Date Created: {{ job.date_created }} <br>
                Description: {{ job.description }} <br>

                {% if job.status == 'Pending' or current_user.id == job.creator_id or current_user.id == job.accepted_id %}
                    Price: {{ "$%.2f"|format(job.price) }} <br>
                {% endif %}

                Street Name: {{ job.location }} <br>
                Zip Code: {{ job.zipcode }} <br>
                Status: {{ job.status }} <br>

                {% if job.status == 'Pending' %}
                    {% if jobs[job] == 1 %}
                        {{ jobs[job] }} request
                    {% else %}
                        {{ jobs[job] }} requests
                    {% endif %}
                    <br>
                {% endif %}

                {% if job.status != 'Pending' %}
                    Accepted by:
                    <a href="{{ url_for('profile.view_profile', user_id=job.accepted_id) }}">
                    {{ accepted[job.accepted_id].first_name }} {{ accepted[job.accepted_id].last_name }}
                    </a>
                    <br>
                {% endif %}

                <a href="{{ url_for('jobs.job', id=job.id) }}" class="btn btn-lg btn-outline"
                   style="background-color: #0300b0; color: white;">
                    <i class="fa fa-globe"></i>
                    View
                </a>

            </div>
            {% endfor %}
        {% endif %}
        <hr>

    </div>
</section>
{% endblock %}